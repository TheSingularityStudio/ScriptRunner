game: "Elderwood Chronicles"
world:
  start: "village_square"
  time_scale: "1 minute real = 10 minutes game"

player:
  attributes:
    strength: 10
    intelligence: 8
    agility: 12
  skills:
    - name: "swordsmanship"
      base_attribute: "strength"
    - name: "stealth"
      base_attribute: "agility"

define_object:
  goblin:
    type: "creature"
    name: "哥布林"
    aliases: ["绿皮", "小怪物"]
    states:
      - name: "health"
        value: 30
        min: 0
        max: 100
    behaviors:
      attack:
        success: "你击中了{target}"
        failure: "你没能打中{target}"
    random:
      health: "20-40"

  ancient_chest:
    type: "container"
    name: "古老的箱子"
    description: "一个布满灰尘的古老箱子，上面刻着奇怪的符号。"

event_system:
  scheduled_events:
    - trigger: "time > 1800"
      action: "spawn_werewolf"
      chance: 0.3

command_parser:
  verbs:
    attack:
      patterns: ["攻击", "打击", "砍", "杀"]
      requires: ["target"]
    examine:
      patterns: ["检查", "查看", "观察", "调查"]
      requires: ["object"]
    use:
      patterns: ["使用", "运用", "动用"]
      requires: ["item", "target?"]
  nouns:
    dynamic_match:
      goblin: "哥布林"
      chest: "箱子"

random_system:
  tables:
    forest_encounters:
      type: "weighted"
      entries:
        - value: "nothing"
          weight: 40
        - value: "hostile_goblin"
          weight: 25
          min_level: 1
        - value: "friendly_traveler"
          weight: 15
          condition: "!player.reputation.evil"
        - value: "random_item"
          weight: 20
          table: "forest_loot"

effects:
  poisoned:
    duration: 5
    tick: "every turn"
    action: "health -= 5"
    message: "你感到毒液在体内蔓延..."

locations:
  village_square:
    description: |
      {time_of_day}的村庄广场上{random_villager_count}个村民正在忙碌。
      {weather_description}
      你可以看到{visible_buildings}。
    variables:
      time_of_day: ["清晨", "正午", "黄昏", "深夜"]
      weather_description: ["细雨蒙蒙", "雾气弥漫", "月光皎洁"]
      visible_buildings: ["铁匠铺", "旅馆", "教堂"]
      random_villager_count: ["2-6"]
    objects:
      - ref: "ancient_chest"
        interactive: true
    exits:
      north: "forest_path"
      east: "abandoned_camp"
    commands:
      - roll_table: "forest_encounters"
    choices:
      - text: "进入森林"
        next: "forest_path"
      - text: "检查古老的箱子"
        next: "chest_opened"
        condition: "!has_opened_chest"

  forest_path:
    description: |
      你走在森林小路上。
      周围是茂密的树木，远处传来鸟儿的叫声。
      你看到前方有一个哥布林！
    objects:
      - ref: "goblin"
        count: "1-3"
        spawn_condition: "!player.stealth"
    choices:
      - text: "攻击哥布林"
        next: "forest_path"
        commands:
          - apply_effect: "poisoned"
      - text: "偷偷溜走"
        next: "village_square"
        condition: "agility > 10"

  chest_opened:
    description: |
      你打开了古老的箱子，发现里面有一把生锈的钥匙。
      钥匙上刻着奇怪的符号。
    commands:
      - set: "has_key = true"
      - add_flag: "has_opened_chest"
    choices:
      - text: "拿起钥匙"
        next: "village_square"
      - text: "离开箱子"
        next: "village_square"
